<!-- templates/mypage.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Page</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      background-color: #f8f9fa;
    }
    .profile-box {
      border: 1px solid #ccc;
      border-radius: 15px;
      padding: 20px;
      background-color: white;
    }
    .avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background-color: #ddd;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 36px;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .summary-box, .card-box {
      border: 1px solid #ccc;
      border-radius: 15px;
      background-color: white;
      padding: 20px;
      height: 100%;
    }
  </style>
</head>
<body>
  {% include 'nav.html' %}

  <div class="container py-4">


    <div class="row g-4">
      <!-- Profile Column -->
      <div class="col-md-3">
        <div class="profile-box text-center">
          <div class="avatar">J</div>
          <h5><strong>{{ username }}</strong></h5>
          <hr>
          <p class="text-start"><strong>About</strong></p>
          <p class="text-start mb-1"><strong>Birth Date</strong><br>April 2, 2010</p>
          <p class="text-start mb-1"><strong>Phone</strong><br>+1 (213)-312-5792</p>
          <p class="text-start mb-1"><strong>Email</strong><br>janewoods@gmail.com</p>
        </div>
      </div>

      <!-- Summary and Cards Column -->
      <div class="col-md-9">
        <!-- Summary Chart Card -->
        <div class="summary-box mb-4">
          <h5 class="text-center mb-3">General Political Orientation Summary</h5>
          <canvas id="summaryChart" height="150"></canvas>
        </div>

        <!-- Three Placeholder Cards -->
        <div class="row g-4">
          <div class="col-md-4">
            <div class="card-box"></div>
          </div>
          <div class="col-md-4">
            <div class="card-box"></div>
          </div>
          <div class="col-md-4">
            <div class="card-box"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Chart Initialization -->
  <script>
    const summaryData = {{ summary_data | tojson }};
    const topics = Object.keys(summaryData);
    const supportCounts = topics.map(t => summaryData[t].support || 0);
    const opposeCounts = topics.map(t => summaryData[t].oppose || 0);
    const neutralCounts = topics.map(t => summaryData[t].neutral || 0);

    const ctx = document.getElementById('summaryChart').getContext('2d');
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: topics,
        datasets: [
          {
            label: 'Support',
            data: supportCounts,
            backgroundColor: '#4CAF50'
          },
          {
            label: 'Oppose',
            data: opposeCounts,
            backgroundColor: '#F44336'
          },
          {
            label: 'Neutral',
            data: neutralCounts,
            backgroundColor: '#FFC107'
          }
        ]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'top' },
          title: {
            display: false
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            title: {
              display: true,
              text: 'Votes'
            }
          }
        }
      }
    });
  </script>

</body>
</html>
